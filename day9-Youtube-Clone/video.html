<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header>
      <div>
        <i class="fa-solid fa-bars"></i>
        <i class="fa-brands fa-youtube" style="color: #cf1717">
          <span>YouTube <sup>IN</sup></span>
        </i>
      </div>
      <div class="search-container">
        <input type="text" oninput="handleSearch(event)" />
        <div id="search-suggestions"></div>
        <button class="search-btn">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>

        <i class="fa-solid fa-microphone"></i>
      </div>
      <div>
        <button class="create">+ Create</button>
        <i class="fa-regular fa-bell"></i>
        <i class="fa-regular fa-user"></i>
      </div>
    </header>

    <aside class="precise-sidebar">
      <ul>
        <li>
          <a href="index.html"><i class="fa-solid fa-house"></i>Home</a>
        </li>
        <li>
          <a href="./history.html"
            ><i class="fa-solid fa-clock-rotate-left"></i>History</a
          >
        </li>
        <li>
          <a href="index.html"><i class="fa-solid fa-house"></i>Trending</a>
        </li>
        <li>
          <a href="index.html"><i class="fa-regular fa-user"></i>You</a>
        </li>
        <li>
          <a href="index.html"><i class="fa-solid fa-download"></i>Downloads</a>
        </li>
      </ul>
    </aside>

    <aside class="detailed-sidebar">
      <ul>
        <li>
          <i class="fa-solid fa-house"></i><a href="./index.html">Home</a>
        </li>
        <li>
          <i class="fa-brands fa-youtube" style="color: #cf1717"></i>
          <a href="#">Shorts</a>
        </li>
        <li>
          <i class="fa-brands fa-youtube" style="color: #cf1717"></i>
          <a href="#">Subscriptions</a>
        </li>
      </ul>
      <hr />
      <h4>You ></h4>
      <ul>
        <li>
          <i class="fa-solid fa-clock-rotate-left"></i>
          <a href="./history.html">History</a>
        </li>
        <li>
          <i class="fa-regular fa-circle-play"></i>
          <a href="#">Playlist</a>
        </li>
        <li>
          <i class="fa-solid fa-video"></i>
          <a href="#">Your videos</a>
        </li>
        <li>
          <i class="fa-solid fa-graduation-cap"></i>
          <a href="#">Your courses</a>
        </li>
        <li>
          <i class="fa-regular fa-clock"></i>
          <a href="#">Watch later</a>
        </li>
        <li>
          <i class="fa-regular fa-thumbs-up"></i>
          <a href="#">Liked videos</a>
        </li>
        <li>
          <i class="fa-solid fa-download"></i>
          <a href="#">Downloads</a>
        </li>
      </ul>
      <hr />
      <h4>Subscriptions</h4>
      <ul></ul>
      <hr />
      <h4>Explore</h4>
      <ul>
        <li>
          <i class="fa-solid fa-arrow-trend-up"></i>
          <a href="#">Trending</a>
        </li>
        <li>
          <i class="fa-solid fa-cart-shopping"></i>
          <a href="#">Shopping</a>
        </li>
        <li>
          <i class="fa-solid fa-music"></i>
          <a href="#">Music</a>
        </li>
        <li>
          <i class="fa-solid fa-film"></i>
          <a href="#">Movies</a>
        </li>
        <li>
          <i class="fa-solid fa-headset"></i>
          <a href="#">Live</a>
        </li>
        <li>
          <i class="fa-solid fa-gamepad"></i>
          <a href="#">Gaming</a>
        </li>
        <li>
          <i class="fa-solid fa-newspaper"></i>
          <a href="#">News</a>
        </li>
        <li>
          <i class="fa-solid fa-trophy"></i>
          <a href="#">Sports</a>
        </li>
        <li>
          <i class="fa-solid fa-graduation-cap"></i>
          <a href="#">Courses</a>
        </li>
        <li>
          <i class="fa-solid fa-shirt"></i>
          <a href="#">Fashion & Beauty</a>
        </li>
        <li>
          <i class="fa-solid fa-podcast"></i>
          <a href="#">Podcats</a>
        </li>
      </ul>
      <hr />
      <h4>More from YouTube</h4>
      <ul>
        <li>
          <i class="fa-brands fa-youtube" style="color: #cf1717"></i>
          <a href="#">YouTube Premium</a>
        </li>
        <li>
          <i class="fa-brands fa-youtube" style="color: #cf1717"></i>
          <a href="#">YouTube Studio</a>
        </li>
        <li>
          <i class="fa-brands fa-youtube" style="color: #cf1717"></i>
          <a href="#">YouTube Music</a>
        </li>
        <li>
          <i class="fa-brands fa-youtube" style="color: #cf1717"></i>
          <a href="#">YouTube Kids</a>
        </li>
      </ul>
      <hr />
      <ul>
        <li>
          <i class="fa-solid fa-gear"></i>
          <a href="#">Settings</a>
        </li>
        <li>
          <i class="fa-solid fa-flag"></i>
          <a href="#">Report history</a>
        </li>
        <li>
          <i class="fa-regular fa-circle-question"></i>
          <a href="#">Help</a>
        </li>
        <li>
          <i class="fa-solid fa-circle-exclamation"></i>
          <a href="#">Send feedback</a>
        </li>
      </ul>
      <hr />
      <p>About Press Copyright Contact us Creators Advertise Developers</p>
      <p>Terms Privacy Policy & Safety How YouTube works Test new features</p>
      <p>Â© 2025 Google LLC</p>
    </aside>

    <main></main>

    <script src="script.js"></script>

    <script>
      const iframe = document.querySelector("iframe");
      const [a, videoId] = window.location.search.split("=");

      const showVideo = () => {
        root.innerHTML = "";
        const videoContainer = document.createElement("div");
        videoContainer.className = "video-container";
        videoContainer.innerHTML = `
          <iframe
            src="https://www.youtube.com/embed/${videoId}"
            title="YouTube video player"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            referrerpolicy="strict-origin-when-cross-origin"
            allowfullscreen
          ></iframe>
    
          <div class="comments">
            <h1><span>0</span> Comments</h1>
            <textarea
              name="comment"
              id="comment"
              placeholder="Add comment"
            ></textarea>
            <button onclick="handleCancel()">cancel</button>
            <button onclick="addComment()">comment</button>
            <div class="comments-container"></div>
          </div>
        `;
        root.appendChild(videoContainer);
      };
      showVideo();

      const addToHistory = () => {
        const youtubeHistory = localStorage.getItem("yt_history");
        if (!youtubeHistory) {
          const newHistory = [videoId];
          localStorage.setItem("yt_history", JSON.stringify(newHistory));
        } else {
          const newHistory = JSON.parse(youtubeHistory);
          let idx = newHistory.indexOf(videoId);
          console.log(idx);
          if (idx != -1) {
            newHistory.splice(idx, 1);
          }
          newHistory.push(videoId);
          localStorage.setItem("yt_history", JSON.stringify(newHistory));
        }
      };
      addToHistory();

      const textarea = document.querySelector("textarea");
      const addComment = () => {
        if (textarea.value != "") {
          const oldComments = localStorage.getItem("comments");
          const obj = JSON.parse(oldComments || "{}");
          if (obj[videoId] != null) {
            obj[videoId].push(textarea.value);
          } else {
            obj[videoId] = [];
            obj[videoId].push(textarea.value);
          }
          localStorage.setItem("comments", JSON.stringify(obj));
          showComment(obj);
          handleCancel();
        }
      };

      const handleCancel = () => {
        textarea.value = "";
      };

      let comments = document.querySelector(".comments-container");
      let commentsCount = document.querySelector(".comments h1 span");

      const showComment = (obj) => {
        comments.innerHTML = "";
        let arr = obj[videoId] || [];
        let count = 0;
        arr.forEach((ele) => {
          count += 1;
          let div = document.createElement("div");
          div.innerText = ele;
          comments.appendChild(div);
          commentsCount.innerText = count;
        });
      };

      let c = JSON.parse(localStorage.getItem("comments") || {});

      showComment(c);
    </script>

    <script
      src="https://kit.fontawesome.com/d4b73298dc.js"
      crossorigin="anonymous"
    ></script>

    <script src="script.js"></script>
  </body>
</html>
